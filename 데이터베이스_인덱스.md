# 인덱스란?

## 1. 인덱스의 개념   
#### 인덱스란 ?
인덱스란 추가적인 쓰기 작업과 저장 공간을 활용하여 데이터베이스 테이블의 검색 속도를 향상시키기 위한 자료구조

#### 인덱스가 필요한 이유
1. 조건에 맞는 데이터를 빠르게 검색하기 위헤
2. 데이터를 빠르게 정렬하거나 그룹핑 하기 위해

#### 인덱스의 특징
1. 인덱스는 항상 최신의 **정렬** 상태를 유지한다.
2. 인덱스는 하나의 데이터베이스 객체이다.
3. 데이터베이스 크기의 약 10% 정도의 저장공간을 필요로 한다.  

## 2. 인덱스의 자료구조  
Array나 List를 사용해서 데이터를 정렬할 수 있겠지만 실제 물리적 이동을 하기보단
인덱스는 트리나 해시를 이용한다.

#### (1) B-트리
![image](https://github.com/2jie0516/TIL/assets/102570281/fe4a39f9-8db1-4e15-bf83-a6ac90bce0c7)
두 개 이상의 노드를 가질 수 있으며 모든 브랜치는 Key -Value 쌍의 데이터를 가진다.

#### (2) B+트리
![image](https://github.com/2jie0516/TIL/assets/102570281/dca55f2f-3220-4112-a390-5b1dc41dca45)  
리프 노드들만 데이터를 가지고 있고 리프 노드를 제외한 노드들은 인덱스(자식 노드의 포인터)만 

가지고 있다. 이로 인해 상대적으로 데이터를 덜 소모한다.

B-tree 는 full scan 을 할 경우 모든 브랜치를 순회해야 하는데 , B+tree 는 리프 노드끼리 연결리스트로 이어져 있기 때문에 굉장히 효율적이다.

하지만 데이터를 찾기 위해서 무조건 리프 노드까지 내려가야 한다는 단점이 있다.

*인덱스의 종류가 클러스터링인지 , 논클러스터링인지에 따라 리프 노드에 오는 데이터 타입이 달라진다!
#### (3) 해시
B트리처럼 범용적으로 사용되지는 않는다.

동등 검색 비교에 최적화 되어 있으며 대용량 데이터에는 쓰이지 않는다.

해쉬 테이블을 통한 인덱스를 해쉬값을 저장하기 때문에 인덱스의 크기가 상대적으로 작다.    

또한 모든 데이터를 찾아 볼 필요없이 해시값에 맞는 데이터를 찾으면 되기 때문에 트리 구조에 비해 탐색이 빠르다.

하지만 정렬이나 범위 검색에는 사용할 수 없고 해시 함수의 결과값이 넓을 경우 메모리가 커짐으로써     

해쉬 테이블의 장점을 잃게 된다.

## 3. 인덱스의 종류

#### (1)**클러스터링 인덱스**

실제 데이터 테이블 자체가 정렬된 인덱스가 된다.

정렬 된 데이터를 기준으로 루트 페이지가 생성이 된다.

테이블당 한개만 존재할 수 있다.

클러스터링 인덱스는 논 클러스터링 인덱스에 비해 조회는 빠르지만 입력/수정/삭제는 느리다.

#### (2) **논 클러스터링 인덱스**

실제 데이터 페이지는 그대로이고 별도의 인덱스를 생성한다.

리프 페이지에 실제 데이터의 페이지 주소를 담는다.

테이블 당 여러개가 존재할 수 있다.

클러스터링 인덱스는 논 클러스터링 인덱스에 비해 조회는 느리지만 입력/수정/삭제는 빠르다.

## 4. 인덱스를 생성하는 법

클러스터링 인덱스

1. 프라이머리 키를 선언하는 경우
2. not null + 유니크 제약 조건을 선언하는 경우 

논 클러스터링 인덱스

1. 유니크 제약 조건을 선언하는 경우 
2. 직접 (유니크)인덱스를 생성하는 경우
```java
ALTER TABLE member ADD CONSTRAINT id PRIMARY KEY(id); → 클러스터링

ALTER TABLE member ADD CONSTRAINT id UNIQUE NOT NULL; → 클러스터링

ALTER TABLE member ADD CONSTRAINT name UNIQUE(name); → 논클러스터링

CREATE INDEX name ON member (name); → 논클러스터링
```

```java
CREATE TABLE member(  
id INT PRIMARY KEY,  
name varchar(20) not null,  
INDEX name_idx (name)  
)  
```
## 5. 인덱스의 장점/단점
### 장점

1. 원하는 데이터를 빠르게 찾을 수 있다.

### 단점

1. 인덱스를 관리하기 위한 추가 작업이 필요

2. 추가 저장 공간 필요

3. 잘못 사용하는 경우 오히려 검색 성능 저하
